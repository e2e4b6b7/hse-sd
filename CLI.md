Команда: Энгель Игорь, Вавилов Марк

Диаграммы: по файлу на этап в репозитории

## Shell   
Центральный класс, содержит основной цикл приложения

`environment: Map<String, String>` - набор переменных окружения  

`fun execute(line: String): Int` - с помощью `parser` преобразует поданную на вход строку в `CommandPipeline`, создаёт базовый контекст (на основе stdin/stdout) и вызывает `execute`.

## Parser
Класс отвечающий за разбиение строки на команды

`commands: List<AbstractCommand>` - список известных команд

Строка разбивается на токены с учётом кавычек, выполняются подстановки - на безкавычном или двойноковычном токене проверяем является-ли он подстановочным, выполняем подставноку (один раз)

Список токенов разбивается на разные компонены пайпа, для каждого компонента создаётся `PreparedComand`, все вместе они собираются в `CommandPipeline`
  
## CommandPipeline  
Класс содержащий цепочку команд и отвечающий за их последовательное исполнение 

`commands: List<PreparedCommand>` - последовательность составных команд

`fun execute(ctx: CommandContext): Int` - запускает все команды последовательно, перенаправляя вывод одной на вход другой. Возвращаемое значение - результат (код возврата) последней команды.

Ошибки в промежуточных командах игнорируются. 

`exit` - прерывает всё исполнение и выходит из программы даже как промежуточная команда

Изменение переменных среды промежуточной командой не учитывается в подстановке для последующих команд, но будет видно им как часть контекста

Выполнение команды - вызов PreparedCommand#execute с подходящим контекстом (тот-же Shell, вход предыдущей команды, вход следующей). Для первой/последней команды вход/выход соответственно совпадают с переданным контекстом.

## AbstractCommand
Абстрактный класс команды

`match` - проверяем задаёт-ли переданная строка данную команду, используется парсером

`execute` - выполняет команду, возвращает код выполнения, ввод/вывод/переменные среды беруться из контекста

## SimpleCommand
Класс "стандартных" команд первым токеном которых обязано быть конкретное слово

`name` - название команды

Реализация `match` - проверяем что первый элемент совпадает с навзанием команды

## CommandSetEnviron
Команда вида `x=y`, устанавливающая переменные среды

## PreparedCommand  
  
По сути пара команда + её аргументы
